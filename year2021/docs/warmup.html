
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Warming up with the power function &#8212; Principles of programming I: Imperative computation (forever alpha) documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reasoning with imperative programs" href="reasoning.html" />
    <link rel="prev" title="Introduction to imperative computation" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Principles of programming I: Imperative computation (forever alpha) documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="welcome.html">
   Welcome
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction to imperative computation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Warming up with the power function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reasoning.html">
   Reasoning with imperative programs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="c0.html">
   More C0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays.html">
   Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gcd.html">
   Assignment 1: GCD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="practice.html">
   Practice problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="searching.html">
   Searching
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sorting.html">
   Sorting - an information theoretic introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="binsearch.html">
   Binary search
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="avl.html">
   AVL trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lists.html">
   Linked lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="c.html">
   Transitioning to C
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/warmup.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#specifying-the-power-function">
   Specifying the power function
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-specification-as-a-program">
   The specification as a program
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preconditions">
   Preconditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#postconditions">
   Postconditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expanded-form">
   Expanded form
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-costs-of-checks">
   Running costs of checks
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tracing-the-states-of-power-spec-and-the-implementation-f">
   Tracing the states of
   <code class="docutils literal notranslate">
    <span class="pre">
     power_spec
    </span>
   </code>
   and the implementation
   <code class="docutils literal notranslate">
    <span class="pre">
     f
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-notes-about-the-c0-language">
   Some notes about the C0 language
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="warming-up-with-the-power-function">
<h1>Warming up with the power function<a class="headerlink" href="#warming-up-with-the-power-function" title="Permalink to this headline">¶</a></h1>
<p>We’ll consider the function shown below and take it as a case
to work with the <code class="docutils literal notranslate"><span class="pre">cc0</span></code> compiler and the <code class="docutils literal notranslate"><span class="pre">coin</span></code> interpreter
and learn about contracts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">f</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>While it may not be clear when you look at the function, it (for
the most part) computes x to the power of y for integers x and y.
However, it has a bug and we’ll work through systematically to
find and fix that bug.</p>
<ol class="arabic">
<li><p>Type the above function into a separate text file (say <code class="docutils literal notranslate"><span class="pre">pow.c0</span></code>) and save
it.</p></li>
<li><p>Load it up in <code class="docutils literal notranslate"><span class="pre">coin</span></code> using <code class="docutils literal notranslate"><span class="pre">coin</span> <span class="pre">pow.c0&lt;enter&gt;</span></code>. (We’ll omit mentioning
<code class="docutils literal notranslate"><span class="pre">&lt;enter&gt;</span></code> key at the end from now on.)</p></li>
<li><p>At the prompt, type <code class="docutils literal notranslate"><span class="pre">#functions</span></code> to see that the <code class="docutils literal notranslate"><span class="pre">f</span></code> function is indeed
defined and available.</p></li>
<li><p>Try various values for inputs and see what you get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="mi">8</span>
<span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="mi">243</span>
<span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="mi">3</span>
<span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span>
<span class="mi">2</span>
<span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="o">-</span><span class="mi">8</span>
<span class="o">&gt;</span> <span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="mi">16</span>
</pre></div>
</div>
</li>
</ol>
<p>As you see, some of those values are correct and some are not as you expect.</p>
<div class="section" id="specifying-the-power-function">
<h2>Specifying the power function<a class="headerlink" href="#specifying-the-power-function" title="Permalink to this headline">¶</a></h2>
<p>Mathematically, you can define the power function for integers
as follows -</p>
<div class="math notranslate nohighlight">
\[\begin{split}x^y = \begin{cases}
        1 &amp; \text{for } y = 0\\
        x \times x^{y-1} &amp; \text{for } y &gt; 0
       \end{cases}\end{split}\]</div>
<p>The above definition (or “specification”) happens to be recursive,
which is permitted in mathematical specifications since it calls
on a proof by induction to establish the definition.</p>
<p>The important point to note here is that this specification does
not consider values of <span class="math notranslate nohighlight">\(y\)</span> that are less than <span class="math notranslate nohighlight">\(0\)</span>.
Therefore it is considered to be meaningless (in the context of
this specification) to ask what is the value of <span class="math notranslate nohighlight">\(2^{-3}\)</span>.</p>
</div>
<div class="section" id="the-specification-as-a-program">
<h2>The specification as a program<a class="headerlink" href="#the-specification-as-a-program" title="Permalink to this headline">¶</a></h2>
<p>In this case, it happens that the recursive definition is also an
“algorithm” to compute the power function, which lends itself
to a recursive implementation in C0 as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">power_spec</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">power_spec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this case, it almost looks reasonable to use this as an
implementation as well, but that won’t be true in general.
For instance, consider the following specification of
addition of two positive integers -</p>
<div class="math notranslate nohighlight">
\[\begin{split}m + n = \begin{cases}
    m &amp; \text{for } n = 0\\
    \text{succ}(m) + \text{pred}(n) &amp; \text{for } n &gt; 0
\end{cases}\end{split}\]</div>
<p>… where the definition of <span class="math notranslate nohighlight">\(\text{succ}\)</span> is from the <a class="reference external" href="https://en.wikipedia.org/wiki/Peano_axioms">Peano axioms</a>
and <span class="math notranslate nohighlight">\(\text{pred}\)</span> can be defined accordingly as well.</p>
<p>While that serves as a sufficient specification, it is not suitable
as an algorithm, let alone being considered for implementation,
since the number of steps it would require to add two integers
is proportional to the values of those integers. You wouldn’t want
to use the following function to add two integers, given you know
how to increment and decrement integers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">add_spec</span><span class="p">(</span><span class="nb">int</span> <span class="n">m</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m</span><span class="p">;</span> <span class="p">}</span>
    <span class="n">m</span><span class="o">++</span><span class="p">;</span>
    <span class="n">n</span><span class="o">--</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">add_spec</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="preconditions">
<h2>Preconditions<a class="headerlink" href="#preconditions" title="Permalink to this headline">¶</a></h2>
<p id="index-0">Since we have a specification of <span class="math notranslate nohighlight">\(x^y\)</span> that is valid only for <span class="math notranslate nohighlight">\(y \geq 0\)</span>,
We need to document in our function that the input must meet that safety constraint,
because we cannot guarantee a correct result if that constraint is not met. You do
that in C0 using the <code class="docutils literal notranslate"><span class="pre">&#64;requires</span></code> contract as shown below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">f</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span>
<span class="o">//</span><span class="nd">@requires</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In C-like languages, the part of a line of code from <code class="docutils literal notranslate"><span class="pre">//</span></code> to the end of that
line is considered a “comment”. C0 however makes use of this to let us specify
formally what we’d otherwise use normal language to “comment” on our function
(maybe like <code class="docutils literal notranslate"><span class="pre">//</span> <span class="pre">Do</span> <span class="pre">not</span> <span class="pre">pass</span> <span class="pre">negative</span> <span class="pre">values</span> <span class="pre">for</span> <span class="pre">y</span></code>).</p>
<p>Load up the new function in <code class="docutils literal notranslate"><span class="pre">coin</span></code> using <code class="docutils literal notranslate"><span class="pre">coin</span> <span class="pre">-d</span> <span class="pre">pow.c0</span></code> and try calling
<code class="docutils literal notranslate"><span class="pre">f(2,-3);</span></code> to see what happens.</p>
</div>
<div class="section" id="postconditions">
<h2>Postconditions<a class="headerlink" href="#postconditions" title="Permalink to this headline">¶</a></h2>
<p id="index-1">Now that we’ve noted the precondition contract, we need to indicate to the world
what the <code class="docutils literal notranslate"><span class="pre">f</span></code> function is intended to compute. For that, we’ll use the <code class="docutils literal notranslate"><span class="pre">power_spec</span></code>
we wrote above. In your file, you’ll need to paste the definition of that function
above the definition of <code class="docutils literal notranslate"><span class="pre">f</span></code> and save your file. Then modify <code class="docutils literal notranslate"><span class="pre">f</span></code> to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">f</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span>
<span class="o">//</span><span class="nd">@requires</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
<span class="o">//</span><span class="nd">@ensures</span> \<span class="n">result</span> <span class="o">==</span> <span class="n">power_spec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Again, try the above definition using <code class="docutils literal notranslate"><span class="pre">coin</span> <span class="pre">-d</span> <span class="pre">pow.c0</span></code>. The “-d” flag causes <code class="docutils literal notranslate"><span class="pre">coin</span></code>
to check the conditions as contracts and not as comments. Does it go through fine?
Can you make sense of what you see?</p>
</div>
<div class="section" id="expanded-form">
<h2>Expanded form<a class="headerlink" href="#expanded-form" title="Permalink to this headline">¶</a></h2>
<p id="index-2">It is useful to understand where the pre and post condition checks go when coin
(and cc0) translate the contract lines. In effect, the function <code class="docutils literal notranslate"><span class="pre">f</span></code> becomes
the form shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>int f(int x, int y)
{
    //@requires y &gt;= 0;
    int r = 1;

    LOOP:
    if (!(y &gt; 0)) goto EXIT_LOOP;
    if (!(y % 2 == 1)) goto SKIP;
    r = r * x;

    SKIP:
    x = x * x;
    y = y / 2;
    goto LOOP;

    EXIT_LOOP:
    {
        int result = r * x;
        //@ensures \result == power_spec(x,y)
        return result;
    }
}
</pre></div>
</div>
<p>Given the expanded view above, the error message given by <code class="docutils literal notranslate"><span class="pre">coin</span></code> ought to become
clearer. We’re modifying the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> as part of the while loop,
but in the end we want to use the original values (which have since been erased)
to check against the <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> function. Therefore, we need to ensure that
the input variables are not modified within the function body so we can do a
valid <code class="docutils literal notranslate"><span class="pre">&#64;ensures</span></code> check:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">f</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span>
<span class="o">//</span><span class="nd">@requires</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
<span class="o">//</span><span class="nd">@ensures</span> \<span class="n">result</span> <span class="o">==</span> <span class="n">power_spec</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nb">int</span> <span class="n">_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
    <span class="nb">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">_y</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_y</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">_x</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">_x</span> <span class="o">=</span> <span class="n">_x</span> <span class="o">*</span> <span class="n">_x</span><span class="p">;</span>
        <span class="n">_y</span> <span class="o">=</span> <span class="n">_y</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">_x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Try this version in <code class="docutils literal notranslate"><span class="pre">coin</span></code> with various input values to see what you get.</p>
<ol class="arabic simple">
<li><p>If the <strong>safety</strong> condition specified by <code class="docutils literal notranslate"><span class="pre">&#64;requires</span></code> line fails, it means
you’re calling the function wrongly and so the responsibility for the error
is with the caller.</p></li>
<li><p>If the <strong>correctness</strong> condition specified by <code class="docutils literal notranslate"><span class="pre">&#64;ensures</span></code> line fails, it
means there is a problem with the implementation that needs to be fixed for
the function to become correct.</p></li>
</ol>
</div>
<div class="section" id="running-costs-of-checks">
<h2>Running costs of checks<a class="headerlink" href="#running-costs-of-checks" title="Permalink to this headline">¶</a></h2>
<p>It costs additional compute time to perform these checks for every function.
In a large system with thousands of functions calling each other, these costs
can add up significantly, resulting in a slow program. Therefore it is desirable
to be able to turn on these checks only when you want to troubleshoot a problem,
and have them be turned off when you have already established that the functions
are correct.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-d</span></code> flag you passed to <code class="docutils literal notranslate"><span class="pre">coin</span></code> turns on these checks. If you do not pass
that flag, then <code class="docutils literal notranslate"><span class="pre">coin</span></code> will not do these checks for you. Similar flags are often
provided by real-world compilers.</p>
<p>Once you know that all calls to your function are safe and you’ve proved your
function to be correct, you can turn off these checks. However, proving correctness
for every function can be very hard in real programs. Some reasonable alternatives
to that include creating “test suites” (which can show the presence of bugs but not
their absence) and maybe</p>
</div>
<div class="section" id="tracing-the-states-of-power-spec-and-the-implementation-f">
<h2>Tracing the states of <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> and the implementation <code class="docutils literal notranslate"><span class="pre">f</span></code><a class="headerlink" href="#tracing-the-states-of-power-spec-and-the-implementation-f" title="Permalink to this headline">¶</a></h2>
<p>We earlier said that imperative programs are characterized by “state changes”.
In this section, we’ll look at how <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> compute their
results to understand why it is worth separating the two, and also to introduce
a model of tracing state changes in an implementation.</p>
<p>To simplify the discussion, we’ll rewrite <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> first to also
use a loop, so that the comparison becomes clearer and is not muddled by
the recursive step. It is, for the moment, sufficient to remember that loops
can be implemented using recursion and vice versa.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">power_spec</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We see that within the above <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> function, there are three “variables”
that may change value as the function performs its steps - <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code>.
We consider these to be columns in a spreadsheet and each row to be a “step”
taken by the function, and trace out the state changes as follows. We take
<code class="docutils literal notranslate"><span class="pre">power_spec(3,8)</span></code> as an example. We also track the boolean “y &gt; 0” as a derived
state for convenience.</p>
<table class="table">
<colgroup>
<col style="width: 33%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 14%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Step</strong></p></th>
<th class="head"><p><strong>x</strong></p></th>
<th class="head"><p><strong>y</strong></p></th>
<th class="head"><p><strong>r</strong></p></th>
<th class="head"><p><strong>y&gt;0</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">power_spec(3,5)</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>UNDEF</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">-</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">2)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>9</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">-</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">3)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">-</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">4)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">-</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>81</p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">5)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>81</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">-</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>243</p></td>
<td><p><strong>false</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">r;</span></code></p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p><strong>243</strong></p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<p>We’ve numbered the steps where we enter the loop each time, so we can see how
many times we run through the loop. We’ve also marked in bold the values of the
<code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> column that are actually relevant for the next step. Now let’s do a
similar thing for our <code class="docutils literal notranslate"><span class="pre">f</span></code> function. At this point, we know that it does
produce the correct value for <code class="docutils literal notranslate"><span class="pre">f(3,5)</span></code>. For <code class="docutils literal notranslate"><span class="pre">f</span></code>, the variables that
constitute its state are still <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<table class="table">
<colgroup>
<col style="width: 24%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Step</strong></p></th>
<th class="head"><p><strong>x</strong></p></th>
<th class="head"><p><strong>y</strong></p></th>
<th class="head"><p><strong>r</strong></p></th>
<th class="head"><p><strong>r*x</strong></p></th>
<th class="head"><p><strong>y&gt;1</strong></p></th>
<th class="head"><p><strong>y%2==1</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">power_spec(3,5)</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>UNDEF</p></td>
<td><p>UNDEF</p></td>
<td><p>true</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">1;</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p><strong>true</strong></p></td>
<td><p><strong>true</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(1)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>3</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>true</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>9</p></td>
<td><p>5</p></td>
<td><p>3</p></td>
<td><p>27</p></td>
<td><p>true</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">/</span> <span class="pre">2;</span></code></p></td>
<td><p>9</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>27</p></td>
<td><p><strong>true</strong></p></td>
<td><p><strong>false</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(2)</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">x</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>81</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>243</p></td>
<td><p>true</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">/</span> <span class="pre">2;</span></code></p></td>
<td><p>81</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p>243</p></td>
<td><p><strong>false</strong></p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code></p></td>
<td><p>81</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p><strong>243</strong></p></td>
<td><p>false</p></td>
<td><p>true</p></td>
</tr>
</tbody>
</table>
<p>So we see that what took 5 loops doing 10 computations in all with <code class="docutils literal notranslate"><span class="pre">power_spec</span></code>
above (and it is easy to see that it takes as many loops as the value of
<code class="docutils literal notranslate"><span class="pre">y</span></code>), the <code class="docutils literal notranslate"><span class="pre">f</span></code> implementation only took 2 loops and 6 computations in all.
This discrepancy grows quickly if you double the value of <code class="docutils literal notranslate"><span class="pre">y</span></code>. When you try
that, you’ll see that <code class="docutils literal notranslate"><span class="pre">power_spec</span></code> will take 10 loop iterations with 20 computations
in all, but <code class="docutils literal notranslate"><span class="pre">f</span></code> will take only 3 loop iterations doing 5 computations in all.
So clearly, <code class="docutils literal notranslate"><span class="pre">f</span></code> is more efficient than <code class="docutils literal notranslate"><span class="pre">power_spec</span></code>. <a class="footnote-reference brackets" href="#eff" id="id1">1</a></p>
<dl class="footnote brackets">
<dt class="label" id="eff"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>We’ll be formalizing this notion of efficiency later in the course. For
now, it is sufficient to understand this notion informally.</p>
</dd>
</dl>
</div>
<div class="section" id="some-notes-about-the-c0-language">
<h2>Some notes about the C0 language<a class="headerlink" href="#some-notes-about-the-c0-language" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>“Statements” in the language are terminated by a semicolon <code class="docutils literal notranslate"><span class="pre">;</span></code>.</p></li>
<li><p>Variables are declared using statements of the form <code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span> <span class="pre">&lt;variable-name&gt;</span>
<span class="pre">=</span> <span class="pre">&lt;initial-value&gt;;</span></code>. For example <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">1;</span></code>. This means that the variable
<code class="docutils literal notranslate"><span class="pre">r</span></code> can only take on integer values.</p></li>
<li><p>The scope of a variable is limited to the immediately enclosing pair of
braces <code class="docutils literal notranslate"><span class="pre">{}</span></code>.</p></li>
<li><p>The conditions for <code class="docutils literal notranslate"><span class="pre">if</span></code> and <code class="docutils literal notranslate"><span class="pre">while</span></code> must be surrounded by parentheses –
like <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(y</span> <span class="pre">%</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">0)</span></code>. Unparenthesized expressions (like what python allows)
are not permitted in C0 and C.</p></li>
<li><p>If a particular <code class="docutils literal notranslate"><span class="pre">if</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> block consists of only one statement
terminated by a semicolon, the braces become optional. So you can write <code class="docutils literal notranslate"><span class="pre">if</span>
<span class="pre">(y</span> <span class="pre">%</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">1)</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">*</span> <span class="pre">x;</span></code> on a single line. However, we recommend that you
consider it as though the braces are mandatory in all situations as it helps
reduce certain kinds of programming errors.</p></li>
</ol>
</div>
</div>


              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="intro.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Introduction to imperative computation</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="reasoning.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Reasoning with imperative programs</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Srikumar K. S.<br/>
        
            &copy; Copyright 2021, Srikumar K. S..<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>